$payload = 'IyBTZXQgdGl0bGUKJEhvc3QuVUkuUmF3VUkuV2luZG93VGl0bGUgPSAiU2Vuc2lYQ2hlYXRGdWNrZXIgLSBAREhPTkkiCgojIEFTQ0lJIEFydCBCYW5uZXIKJGFzY2lpID0gQCIKX19fX19fX19fIC5fXyAgICAgICAgICAgICAgICAgICBfXyBfX19fX19fX19fXyAgICAgICAgICAgICBfXyAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX19fICBfX18KXF8gICBfX18gXHwgIHxfXyAgIF9fX18gX19fX18gXy8gIHxcXyAgIF9fX19fL18gX18gICBfX19fIHwgIHwgX18gX19fX19fX19fX18gICAgICAgICAgICBcICAgXC8gIC8KLyAgICBcICBcL3wgIHwgIFxfLyBfXyBcXF9fICBcXCAgIF9fXCAgICBfXyl8ICB8ICBcXy8gX19fXHwgIHwvIC8vIF9fIFxfICBfXyBcICAgX19fX19fICAgXCAgICAgLyAKXCAgICAgXF9fX3wgICBZICBcICBfX18vIC8gX18gXHwgIHwgfCAgICAgXCB8ICB8ICAvXCAgXF9fX3wgICAgPFwgIF9fXy98ICB8IFwvICAvX19fX18vICAgLyAgICAgXCAKIFxfX19fX18gIC9fX198ICAvXF9fXyAgPl9fX18gIC9fX3wgXF9fXyAgLyB8X19fXy8gIFxfX18gID5fX3xfIFxcX19fICA+X198ICAgICAgICAgICAgICAvX19fL1wgIFwKICAgICAgICBcLyAgICAgXC8gICAgIFwvICAgICBcLyAgICAgICAgIFwvICAgICAgICAgICAgICBcLyAgICAgXC8gICAgXC8gICAgICAgICAgICAgICAgICAgICAgICBcXy8KIkAKCiMgRGVmaW5lIHBhdGhzCiRnaG9zdERpciA9ICIkZW52OkFQUERBVEFcSERHaG9zdCIKJGZha2VFeGUgPSAiJGdob3N0RGlyXEhELVBsYXllci5leGUiCiRzcmNDb2RlID0gIiRnaG9zdERpclxnaG9zdC5jcyIKCiMgQ29uc29sZSB3aWR0aAokY29uc29sZVdpZHRoID0gJEhvc3QuVUkuUmF3VUkuV2luZG93U2l6ZS5XaWR0aAoKZnVuY3Rpb24gV3JpdGUtQ2VudGVyZWQgewogICAgcGFyYW0oW3N0cmluZ10kdGV4dCwgW0NvbnNvbGVDb2xvcl0kY29sb3IgPSAiV2hpdGUiKQogICAgJHBhZCA9IFtNYXRoXTo6TWF4KDAsIFtNYXRoXTo6Rmxvb3IoKCRjb25zb2xlV2lkdGggLSAkdGV4dC5MZW5ndGgpIC8gMikpCiAgICBXcml0ZS1Ib3N0ICgnICcgKiAkcGFkICsgJHRleHQpIC1Gb3JlZ3JvdW5kQ29sb3IgJGNvbG9yCn0KCmZ1bmN0aW9uIFNob3ctSGVhZGVyIHsKICAgIENsZWFyLUhvc3QKICAgICJgbiIgICMgT25lIGxpbmUgdG9wIHBhZGRpbmcKICAgIGZvcmVhY2ggKCRsaW5lIGluICRhc2NpaS5TcGxpdCgiYG4iKSkgewogICAgICAgIFdyaXRlLUNlbnRlcmVkICRsaW5lIEN5YW4KICAgIH0KCiAgICAkZGVzYyA9IEAiClRoaXMgdG9vbCBwcm90ZWN0cyB5b3VyIHN5c3RlbSBmcm9tIHVud2FudGVkIHBhbmVsIGluamVjdGlvbnMgYW5kIFVJIHRha2VvdmVycy4KQnVpbHQgd2l0aCBhIHNpbGVudCBwcm9jZXNzIHJlZGlyZWN0aW9uIG1ldGhvZCB0aGF0IGxpbWl0cyBwcm9jZXNzIGhpamFja2luZy4KCkNvbXBsZXggcnVudGltZSBkZWZlbnNlIGxvZ2ljIGVuc3VyZXMgZW5oYW5jZWQgc2VjdXJpdHkgd2hpbGUgbWFza2luZyBvcGVyYXRpb25zLgpOb3RoaW5nIHZpc2libGUsIG5vdGhpbmcgdHJhY2VhYmxlIOKAlCBqdXN0IHJhdyBibG9ja2luZyBwb3dlci4KCkNob29zZSBhbiBvcHRpb24gdG8gYmVnaW46CiJACgogICAgZm9yZWFjaCAoJGxpbmUgaW4gJGRlc2MuU3BsaXQoImBuIikpIHsKICAgICAgICBXcml0ZS1DZW50ZXJlZCAkbGluZSBEYXJrR3JheQogICAgfQoKICAgIFdyaXRlLUNlbnRlcmVkICJbMV0gUGF0Y2ggUGFuZWwiIEdyYXkKICAgIFdyaXRlLUNlbnRlcmVkICJbMl0gU2FmZSBFeGl0IiBHcmF5CiAgICBXcml0ZS1Ib3N0ICIiCn0KCiMgQyMgQ29kZSBmb3IgaGlkZGVuIGdob3N0IHByb2Nlc3MKJGNvZGUgPSBAIgp1c2luZyBTeXN0ZW07CnVzaW5nIFN5c3RlbS5XaW5kb3dzLkZvcm1zOwp1c2luZyBTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXM7CgpjbGFzcyBHaG9zdEZvcm0gOiBGb3JtCnsKICAgIFtEbGxJbXBvcnQoInVzZXIzMi5kbGwiKV0gc3RhdGljIGV4dGVybiBpbnQgU2hvd1dpbmRvdyhJbnRQdHIgaFduZCwgaW50IG5DbWRTaG93KTsKICAgIFtEbGxJbXBvcnQoInVzZXIzMi5kbGwiKV0gc3RhdGljIGV4dGVybiBpbnQgU2V0V2luZG93TG9uZyhJbnRQdHIgaFduZCwgaW50IG5JbmRleCwgdWludCBkd05ld0xvbmcpOwogICAgW0RsbEltcG9ydCgidXNlcjMyLmRsbCIpXSBzdGF0aWMgZXh0ZXJuIHVpbnQgR2V0V2luZG93TG9uZyhJbnRQdHIgaFduZCwgaW50IG5JbmRleCk7CgogICAgY29uc3QgaW50IFNXX0hJREUgPSAwOwogICAgY29uc3QgaW50IEdXTF9FWFNUWUxFID0gLTIwOwogICAgY29uc3QgdWludCBXU19FWF9UT09MV0lORE9XID0gMHgwMDAwMDA4MDsKCiAgICBbU1RBVGhyZWFkXQogICAgc3RhdGljIHZvaWQgTWFpbigpCiAgICB7CiAgICAgICAgdmFyIGZvcm0gPSBuZXcgR2hvc3RGb3JtKCk7CiAgICAgICAgZm9ybS5Mb2FkICs9IChzLCBlKSA9PgogICAgICAgIHsKICAgICAgICAgICAgSW50UHRyIGhhbmRsZSA9IGZvcm0uSGFuZGxlOwogICAgICAgICAgICBTaG93V2luZG93KGhhbmRsZSwgU1dfSElERSk7CiAgICAgICAgICAgIHVpbnQgZXhTdHlsZSA9IEdldFdpbmRvd0xvbmcoaGFuZGxlLCBHV0xfRVhTVFlMRSk7CiAgICAgICAgICAgIFNldFdpbmRvd0xvbmcoaGFuZGxlLCBHV0xfRVhTVFlMRSwgZXhTdHlsZSB8IFdTX0VYX1RPT0xXSU5ET1cpOwogICAgICAgIH07CiAgICAgICAgZm9ybS5TaG93SW5UYXNrYmFyID0gZmFsc2U7CiAgICAgICAgZm9ybS5Gb3JtQm9yZGVyU3R5bGUgPSBGb3JtQm9yZGVyU3R5bGUuTm9uZTsKICAgICAgICBmb3JtLk9wYWNpdHkgPSAwOwogICAgICAgIEFwcGxpY2F0aW9uLlJ1bihmb3JtKTsKICAgIH0KfQoiQAoKIyBIZWxwZXJzCmZ1bmN0aW9uIFdyaXRlLUNvZGUgewogICAgaWYgKC1ub3QgKFRlc3QtUGF0aCAkZ2hvc3REaXIpKSB7CiAgICAgICAgTmV3LUl0ZW0gLUl0ZW1UeXBlIERpcmVjdG9yeSAtUGF0aCAkZ2hvc3REaXIgLUZvcmNlIHwgT3V0LU51bGwKICAgIH0KICAgIFtJTy5GaWxlXTo6V3JpdGVBbGxUZXh0KCRzcmNDb2RlLCAkY29kZSkKfQoKZnVuY3Rpb24gQ29tcGlsZS1GYWtlIHsKICAgICRjc2MgPSAiJHtlbnY6V0lORElSfVxNaWNyb3NvZnQuTkVUXEZyYW1ld29ya1x2NC4wLjMwMzE5XGNzYy5leGUiCiAgICBpZiAoLW5vdCAoVGVzdC1QYXRoICRjc2MpKSB7CiAgICAgICAgV3JpdGUtQ2VudGVyZWQgIlshXSBjc2MuZXhlIG5vdCBmb3VuZCEiIFJlZAogICAgICAgIHJldHVybiAkZmFsc2UKICAgIH0KICAgIFN0YXJ0LVByb2Nlc3MgLVdpbmRvd1N0eWxlIEhpZGRlbiAtRmlsZVBhdGggJGNzYyAtQXJndW1lbnRMaXN0ICIvdGFyZ2V0OndpbmV4ZSIsICIvb3V0OmAiJGZha2VFeGVgIiIsICJgIiRzcmNDb2RlYCIiIC1XYWl0CiAgICByZXR1cm4gKFRlc3QtUGF0aCAkZmFrZUV4ZSkKfQoKZnVuY3Rpb24gU3RhcnQtRmFrZSB7CiAgICBTdGFydC1Qcm9jZXNzIC1XaW5kb3dTdHlsZSBIaWRkZW4gLUZpbGVQYXRoICRmYWtlRXhlCn0KCmZ1bmN0aW9uIENsZWFudXAtRmlsZXMgewogICAgR2V0LVByb2Nlc3MgLU5hbWUgIkhELVBsYXllciIgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfCBTdG9wLVByb2Nlc3MgLUZvcmNlIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlCiAgICBTdGFydC1TbGVlcCAtTWlsbGlzZWNvbmRzIDMwMAogICAgaWYgKFRlc3QtUGF0aCAkZmFrZUV4ZSkgeyBSZW1vdmUtSXRlbSAkZmFrZUV4ZSAtRm9yY2UgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfQogICAgaWYgKFRlc3QtUGF0aCAkc3JjQ29kZSkgeyBSZW1vdmUtSXRlbSAkc3JjQ29kZSAtRm9yY2UgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfQogICAgaWYgKChUZXN0LVBhdGggJGdob3N0RGlyKSAtYW5kICgoR2V0LUNoaWxkSXRlbSAkZ2hvc3REaXIpLkNvdW50IC1lcSAwKSkgewogICAgICAgIFJlbW92ZS1JdGVtICRnaG9zdERpciAtRm9yY2UgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUKICAgIH0KfQoKIyBNYWluCndoaWxlICgkdHJ1ZSkgewogICAgU2hvdy1IZWFkZXIKCiAgICAjIElubGluZSBpbnB1dAogICAgJHByb21wdCA9ICI+Pj4gQ2hvb3NlIG9wdGlvbiAoMSBvciAyKTogIgogICAgJHBhZCA9IFtNYXRoXTo6TWF4KDAsIFtNYXRoXTo6Rmxvb3IoKCRjb25zb2xlV2lkdGggLSAkcHJvbXB0Lkxlbmd0aCAtIDIpIC8gMikpICAjIC0yIHBhZGRpbmcKICAgIFdyaXRlLUhvc3QgKCcgJyAqICRwYWQgKyAkcHJvbXB0KSAtTm9OZXdsaW5lIC1Gb3JlZ3JvdW5kQ29sb3IgWWVsbG93CiAgICAkY2hvaWNlID0gUmVhZC1Ib3N0CgogICAgc3dpdGNoICgkY2hvaWNlKSB7CiAgICAgICAgIjEiIHsKICAgICAgICAgICAgV3JpdGUtQ29kZQogICAgICAgICAgICBpZiAoQ29tcGlsZS1GYWtlKSB7CiAgICAgICAgICAgICAgICBTdGFydC1GYWtlCiAgICAgICAgICAgICAgICBXcml0ZS1DZW50ZXJlZCAiW2luZm9dIEFsbCBQYW5lbHMgYXJlIG5vdyBQYXRjaGVkISIgR3JlZW4KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIFdyaXRlLUNlbnRlcmVkICJbIV0gVW5leHBlY3RlZCBFcnJvci4gQ29udGFjdCBEZXYgISEiIFJlZAogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgICIyIiB7CiAgICAgICAgICAgIENsZWFudXAtRmlsZXMKICAgICAgICAgICAgV3JpdGUtQ2VudGVyZWQgIltpbmZvXSBTYWZlIEV4aXQ6IFN5c3RlbSByZXR1cm4gVG8gTm9ybWFsLiIgRGFya0dyZWVuCiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgfQogICAgICAgIGRlZmF1bHQgewogICAgICAgICAgICBXcml0ZS1DZW50ZXJlZCAiWyFdIEludmFsaWQgY2hvaWNlLiIgUmVkCiAgICAgICAgfQogICAgfQoKICAgIFdyaXRlLUhvc3QgIiIKICAgIFdyaXRlLUNlbnRlcmVkICJQcmVzcyBFTlRFUiB0byByZXR1cm4gdG8gbWFpbiBtZW51Li4uIiBEYXJrR3JheQogICAgW3ZvaWRdW1N5c3RlbS5Db25zb2xlXTo6UmVhZExpbmUoKQp9Cg==';
$decoded = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($payload));
Invoke-Expression $decoded
